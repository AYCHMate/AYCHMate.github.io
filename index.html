<!DOCTYPE html>
<html lang="en" data-ng-app="cryptomator" data-ng-strict-di="true">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Cryptomator - Free and Open Source AES Encryption for your Cloud</title>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"/>
  <link rel="stylesheet" href="css/main.css"/>
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.png" type="image/png" sizes="96x96">
  <link rel="payment" href="https://flattr.com/submit/auto?user_id=totalvoidness&amp;url=https%3A%2F%2Fcryptomator.org&amp;title=Cryptomator&amp;language=en_GB&amp;category=software" type="text/html" />
  <meta name="description" content="Cryptomator provides free client-side AES encryption for Dropbox, Google Drive and other cloud storage services. Securely protect your documents from unauthorized access. Cryptomator is open source software, so you can rest assured there are no backdoors." />
  <meta property="og:title" content="Cryptomator - Free AES Encryption for your Cloud" />
  <meta property="og:site_name" content="Cryptomator.org" />
  <meta property="og:url" content="https://cryptomator.org/" />
  <meta property="og:description" content="Cryptomator provides free client-side AES encryption for your cloud files. You choose a directory and Cryptomator mounts it as a new encrypted volume. Whatever you save on this volume will end up as encrypted files in the directory." />
  <meta property="og:image" content="https://cryptomator.org/img/what_is_cryptomator.png" />
  <script defer="defer" src="//api.flattr.com/js/0.6/load.js?mode=auto"></script>
  <script defer="defer" src="//code.jquery.com/jquery-2.1.1.min.js"></script>
  <script defer="defer" src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.compat.min.js"></script>
  <script defer="defer" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  <script defer="defer" src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.8/angular.min.js"></script>
  <script defer="defer" src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.8/angular-cookies.min.js"></script>
  <script defer="defer" src="js/app.js"></script>
</head>

<body data-spy="scroll">

  <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#cryptomator">Cryptomator</a>
      </div>
      <div id="navbar" class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="#download">Download</a></li>
          <li><a href="#howto">How It Works</a></li>
          <li><a href="#features">Features</a></li>
          <li><a href="#newsletter">Newsletter</a></li>
          <li><a href="#security">Security Details</a></li>
          <li><a href="#contribute">Get Involved</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li class="dropdown" data-ng-controller="DonateCtrl">
  					<a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Donate <span class="caret"></span></a>
  					<ul class="dropdown-menu" role="menu">
              <li class="text-center">
                <p>Donate via Paypal:</p>
                <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <div class="form-group">
                    <input type="hidden" name="cmd" value="_s-xclick"/>
                    <input type="hidden" name="hosted_button_id" value="94N2XGABKU2NE"/>
                    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                    <img alt="" border="0" src="https://www.paypalobjects.com/de_DE/i/scr/pixel.gif" width="1" height="1">
                  </div>
                </form>
              </li>
              <li class="text-center">
                <p>Donate Bitcoins:</p>
                <div class="form-group btn-group">
                  <a class="btn btn-default btn-sm" href="bitcoin:1NeRKGXG5ZJ6CBVVbxaFrwq5kWG34vT8wh?amount=0.05&amp;label=Cryptomator">
                    <span class="glyphicon glyphicon-bitcoin"></span> Donate
                  </a>
                  <button class="btn btn-default btn-sm" data-ng-click="copyBitcoinAddress()" title="Copy Bitcoin Address">
                    <span class="glyphicon glyphicon-copy"></span>
                  </button>
                </div>
              </li>
  						<li class="text-center">
                <p>Support on Flattr:</p>
                <a class="FlattrButton" style="display:none;" rev="flattr;button:compact;" href="http://github.com/totalvoidness/cryptomator"></a>
              </li>
  					</ul>
  				</li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- #################### CRYPTOMATOR #################### -->

  <span class="clearfix anchor" id="cryptomator"></span>
  <div class="jumbotron">
    <div class="container">

      <div class="row">
        <div class="col-md-4">
          <img src="img/hello.png" srcset="img/hello.png 1x, img/hello@2x.png 2x" class="img-responsive center-block" alt="Cryptomator logo" />
        </div>
        <div class="col-md-8 hidden-xs hidden-sm">
          <h1>Cryptomator</h1>
          <h2>Free client-side AES encryption for your cloud files. Open source software: No backdoors, no registration.</h2>
          <a href="#download" class="btn btn-lg btn-success" role="button">Free Download</a>
          <a href="#newsletter" class="btn btn-lg btn-primary" role="button">iOS Beta Invite</a>
        </div>
        <div class="col-md-8 visible-xs visible-sm text-center">
          <h1>Cryptomator</h1>
          <h2>Free client-side AES encryption for your cloud files. Open source software: No backdoors, no registration.</h2>
          <a href="#download" class="btn btn-lg btn-success" role="button">Free Download</a>
          <a href="#newsletter" class="btn btn-lg btn-primary" role="button">iOS Beta Invite</a>
        </div>
      </div>

    </div>
  </div>

  <!-- #################### WHAT IS CRYPTOMATOR #################### -->

  <div class="container">

    <img src="img/what_is_cryptomator.png" class="img-responsive center-block" srcset="img/what_is_cryptomator.png 1140w, img/what_is_cryptomator_570.png 768w" alt="Two Finder windows, one of them showing a Dropbox folder containing encrypted files, the second one showing the Cryptomator drive." />

  </div>

  <!-- #################### DOWNLOAD #################### -->

  <span class="clearfix anchor" id="download"></span>
  <div class="container">

    <div class="page-header text-center">
      <h2>Download</h2>
      <p class="lead">Version 0.10 (29th October, 2015)</p>
    </div>

    <div class="alert alert-warning" role="alert">
      <h4>Disclaimer - Cryptomator is beta software</h4>
      <p>By downloading Cryptomator, you agree to only use it for testing only with recoverable data. Cryptomator contributors will not be liable for any loss or damage to your data.</p>
    </div>

    <div class="row" data-ng-controller="DownloadCtrl">

      <div class="text-center" data-ng-class="{'col-md-12': !showAllDownloads, 'col-md-3': showAllDownloads}" data-ng-show="isOSWindows || showAllDownloads">
        <div class="text-center">
          <img src="img/windows_icon128.png" alt="Windows logo" />
          <div class="caption text-center" itemscope itemtype="http://schema.org/SoftwareApplication">
            <meta itemprop="applicationCategory" content="Productivity" />
            <meta itemprop="applicationSubCategory" content="Encryption" />
            <meta itemprop="softwareVersion" content="0.10.0" />
            <meta itemprop="image" content="https://cryptomator.org/img/logo.png" />
            <meta itemprop="description" content="Client-side AES encryption for your cloud files." />
            <h4 itemprop="name">Cryptomator for <span itemprop="operatingSystem">Windows</span></h4>
            <p>
              <a itemprop="downloadUrl" href="//bintray.com/artifact/download/cryptomator/cryptomator/Cryptomator-0.10.0.exe" data-ng-click="logDownloadload('Cryptomator-0.10.0.exe')" class="btn btn-success" role="button">
                <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> Cryptomator-0.10.0.exe<br/>
                <span class="small">(For 32 bit systems)</span>
              </a>
            </p>
            <p class="sha1sum">f94dbc2adbe5b6af40517c9773e4dd275d81ff6c</p>
            <p>
              <a itemprop="downloadUrl" href="//bintray.com/artifact/download/cryptomator/cryptomator/Cryptomator-0.10.0-amd64.exe" data-ng-click="logDownload('Cryptomator-0.10.0-amd64.exe')" class="btn btn-success" role="button">
                <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> Cryptomator-0.10.0-amd64.exe<br/>
                <span class="small">(For 64 bit systems)</span>
              </a>
            </p>
            <p class="sha1sum">5c32065f99ec74fd04b4fd33fcf5ba1717466d75</p>
            <p>
              Minimum: Windows Vista SP2
            </p>
          </div>
        </div>
      </div>

      <div data-ng-class="{'col-md-12': !showAllDownloads, 'col-md-3': showAllDownloads}" data-ng-show="isOSMac || showAllDownloads">
        <div class="text-center">
          <img src="img/finder_icon128.png" alt="Finder logo" />
          <div class="caption text-center" itemscope itemtype="http://schema.org/SoftwareApplication">
            <meta itemprop="applicationCategory" content="Productivity" />
            <meta itemprop="applicationSubCategory" content="Encryption" />
            <meta itemprop="softwareVersion" content="0.10.1" />
            <meta itemprop="image" content="https://cryptomator.org/img/logo.png" />
            <meta itemprop="description" content="Client-side AES encryption for your cloud files." />
            <h4 itemprop="name">Cryptomator for <span itemprop="operatingSystem">Mac OS X</span></h4>
            <p>
              <a itemprop="downloadUrl" href="//bintray.com/artifact/download/cryptomator/cryptomator/Cryptomator-0.10.1.dmg" data-ng-click="logDownload('Cryptomator-0.10.1.dmg')" class="btn btn-success" role="button">
                <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> Cryptomator-0.10.1.dmg
              </a>
            </p>
            <p class="sha1sum">0546191140789e1812548e5bc5932695769a34ef</p>
            <p>
              Minimum: OS X 10.8.3
            </p>
          </div>
        </div>
      </div>

      <div class="text-center" data-ng-class="{'col-md-12': !showAllDownloads, 'col-md-3': showAllDownloads}" data-ng-show="isOSLinux || showAllDownloads">
        <div class="text-center">
          <img src="img/tux_icon128.png" alt="Tux">
          <div class="caption text-center" itemscope itemtype="http://schema.org/SoftwareApplication">
            <meta itemprop="applicationCategory" content="Productivity" />
            <meta itemprop="applicationSubCategory" content="Encryption" />
            <meta itemprop="softwareVersion" content="0.10.0" />
            <meta itemprop="image" content="https://cryptomator.org/img/logo.png" />
            <meta itemprop="description" content="Client-side AES encryption for your cloud files." />
            <h4 itemprop="name">Cryptomator for <span itemprop="operatingSystem">Linux</span></h4>
            <p>
              <a itemprop="downloadUrl" href="//bintray.com/artifact/download/cryptomator/cryptomator-deb/pool/contrib/c/cryptomator/cryptomator-0.10.0.deb" data-ng-click="logDownload('Cryptomator-0.10.0.deb')" class="btn btn-success" role="button">
                <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> Cryptomator-0.10.0.deb<br/>
                <span class="small">For Debian-based OS</span>
              </a>
            </p>
            <p class="sha1sum">cdea62c2f1564406deda4170a6b54511e8d5cf87</p>
            <p>
              See <a href="http://www.oracle.com/technetwork/java/javase/certconfig-2095354.html" target="_blank">detailed system requirements</a>
            </p>
          </div>
        </div>
      </div>

      <div class="text-center" data-ng-class="{'col-md-12': !showAllDownloads, 'col-md-3': showAllDownloads}" data-ng-show="showAllDownloads">
        <div class="text-center">
          <img src="img/java_icon128.png" alt="Java icon" />
          <div class="caption text-center">
            <h4>Generic JAR-File</h4>
            <p>
              <a href="https://github.com/cryptomator/cryptomator/releases" target="_blank" class="btn btn-success" role="button">
                <span class="glyphicon glyphicon-globe" aria-hidden="true"></span> Cryptomator.jar<br/>
                <span class="small">Available on GitHub</span>
              </a>
            </p>
            <p>
              Requires JRE 8 + optional JCE unlimited strength policy files
            </p>
          </div>
        </div>
      </div>

      <div class="col-md-12 text-center">
        <hr>
        <p data-ng-show="!showAllDownloads"><a class="btn btn-default" role="button" data-ng-click="showAllDownloads = true">Show all downloads</a></p>
        <p data-ng-show="showAllDownloads"><a href="downloads" class="btn btn-default" role="button">Show all versions</a></p>
      </div>

    </div>

  </div>

  <!-- ################### HOWTO #################### -->

  <span class="clearfix anchor" id="howto"></span>
  <div class="jumbotron">
    <div class="container">

      <div class="page-header text-center">
        <h2>How to Encrypt Your Dropbox</h2>
        <p class="lead">This video explains how to use Cryptomator to securely store files inside Dropbox, Google Drive, OneDrive, ownCloud, you name it.</p>
      </div>
      <div class="embed-responsive embed-responsive-16by9">
        <iframe type="text/html" src="https://www.youtube.com/embed/zhDg2qnLgfo?autoplay=0&origin=https://cryptomator.org" frameborder="0"></iframe>
      </div>

    </div>
  </div>

  <!-- #################### FEATURES #################### -->

  <span class="clearfix anchor" id="features"></span>
  <div class="container">

    <div class="page-header text-center">
      <h2>Features</h2>
      <p class="lead">Cryptomator provides transparent, client-side encryption for your cloud. Securely protect your documents from unauthorized access. Cryptomator is open source software, so you can rest assured there are no backdoors.</p>
    </div>

    <div class="row">
      <div class="col-md-4">
        <div class="text-center">
          <div class="modal screenshot fade" id="screenCreateModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-body">
              <img src="img/screen_create_shadow.png" alt="Creating new vaults" width="752" />
            </div>
          </div>
          <img src="img/screen_create.png" srcset="img/screen_create.png 1x, img/screen_create@2x.png 2x" alt="Creating new vaults" width="320" class="cursor-pointer" data-toggle="modal" data-target="#screenCreateModal" />
          <div class="caption">
            <h3>Create</h3>
            <p>You can create as many encrypted directories as you like. Two in Dropbox, one in OneDrive, one on your flash drive.</p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="text-center">
          <div class="modal screenshot fade" id="screenUnlockModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-body">
              <img src="img/screen_unlock_shadow.png" alt="Unlocking vaults" width="752" />
            </div>
          </div>
          <img src="img/screen_unlock.png" srcset="img/screen_unlock.png 1x, img/screen_unlock@2x.png 2x" alt="Unlocking vaults" width="320" class="cursor-pointer" data-toggle="modal" data-target="#screenUnlockModal" />
          <div class="caption">
            <h3>Unlock</h3>
            <p>Enter your password and start access your files. Wasn&apos;t that easy?</p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="text-center">
          <div class="modal screenshot fade" id="screenUnlockedModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-body">
              <img src="img/screen_unlocked_shadow.png" alt="Using vaults" width="752" />
            </div>
          </div>
          <img src="img/screen_unlocked.png" srcset="img/screen_unlocked.png 1x, img/screen_unlocked@2x.png 2x" alt="Using vaults" width="320" class="cursor-pointer" data-toggle="modal" data-target="#screenUnlockedModal" />
          <div class="caption">
            <h3>Use</h3>
            <p>Every unlocked vault is accessible as a virtual hard drive in your operating system. Want to transfer files from one vault to another? No problem.</p>
          </div>
        </div>
      </div>
    </div>

    <hr>

    <div class="row">
      <div class="col-md-4">
        <h4>Secure</h4>
        <p>Cryptomator encrypts your files&apos; contents and names using AES with up to 256 bit keylength. Scrypt hardens your key against bruteforcing.</p>
      </div>
      <div class="col-md-4">
        <h4>Transparent</h4>
        <p>Your applications can work with encrypted files without even noticing. Cryptomator will make your encrypted folder available as a virtual hard drive.</p>
      </div>
      <div class="col-md-4">
        <h4>Lean</h4>
        <p>Cryptomator doesn&apos;t flood your computer with funny support files or even drivers. Also Cryptomator&apos;s internals are very simple. We believe, that complexity kills security.</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-4">
        <h4>Easy</h4>
        <p>Choose a password and continue working normally on your files. No configuration needed. No accounts required.</p>
      </div>
      <div class="col-md-4">
        <h4>Trustworthy</h4>
        <p>Cryptomator is secure. Ever read this sentence before? Well in this case you don&apos;t need to trust us. You can control us. Cryptomator is completely open source software.</p>
      </div>
      <div class="col-md-4">
        <h4>Discreet</h4>
        <p>Cryptomator doesn&apos;t need your cloud passwords. It works on your local machine and doesn&apos;t care about the accounts you use.</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-4">
        <h4>Compatible</h4>
        <p>Dropbox, OneDrive, Google Drive, ...? Cryptomator works with every single cloud storage provider, as long as your files are sync&apos;ed to your computer.</p>
      </div>
      <div class="col-md-4">
        <h4>Multiplatform</h4>
        <p>Cryptomator is based on Java technology and runs on all major desktop operating systems. Smartphone apps will follow.</p>
      </div>
      <div class="col-md-4">
        <h4>Free and open source</h4>
        <p>Other than most cloud encryption tools, Cryptomator doesn&apos;t cost a penny. You don&apos;t even need to create an account! It is open source software licensed under the MIT X Consortium license, so you will never stand in front of locked doors in the future.</p>
      </div>
    </div>

  </div>

  <!-- #################### MAILING LIST #################### -->

  <span class="clearfix anchor" id="newsletter"></span>
  <div class="jumbotron">
    <div class="container">

      <div class="page-header text-center">
        <h2>Subscribe to our Mailing List</h2>
      </div>
      <div class="row">
        <div class="col-md-8 col-md-offset-2">
          <div>
            <form action="//cryptomator.us10.list-manage.com/subscribe/post?u=e9345a3370a9a703b20c45e3c&amp;id=1a6e2c337b" method="post" name="mc-embedded-subscribe-form" class="form-horizontal validate" target="_blank" novalidate>
              <div>
                <div class="form-group">
                	<label for="mce-EMAIL" class="col-sm-2 control-label">Email Address</label>
                  <div class="col-sm-10">
                	   <input type="email" value="" name="EMAIL" class="required email form-control" />
                  </div>
                </div>
                <div class="form-group">
                  <label for="mce-group[3693]-3693-0" class="col-sm-2 control-label">iOS Beta</label>
                  <div class="col-sm-10">
                    <div class="checkbox">
                      <label><input type="checkbox" value="1" name="group[3693][1]" /> Yes, I would like to participate in the iOS beta</label>
                    </div>
                  </div>
                </div>
              	<!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;"><input type="text" name="b_e9345a3370a9a703b20c45e3c_1a6e2c337b" tabindex="-1" value=""></div>
                <div class="form-group">
                  <div class="col-sm-offset-2 col-sm-10">
                    <input type="submit" value="Subscribe" name="subscribe" class="btn btn-primary"/>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- #################### SECURITY #################### -->

  <span class="clearfix anchor" id="security"></span>
  <div class="container">

    <div class="page-header text-center">
      <h2>Security - Technical Details</h2>
      <p class="lead">The following information should help to understand fundamental security concepts and create 3rd party applications capable of accessing Cryptomator vaults.</p>
    </div>

    <!-- just definitions -->
    <svg height="0" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="StickArrow_Marker" viewBox="-1 -4 10 8" markerWidth="10" markerHeight="8" color="black">
          <g>
            <path d="M 8 0 L 0 0 M 0 -3 L 8 0 L 0 3" fill="none" stroke="currentColor" stroke-width="1" />
          </g>
        </marker>
      </defs>
    </svg>

    <div class="row">
      <div class="col-md-12">
        <h3>Key Derivation and Masterkey Decryption</h3>
        <svg version="1.1" viewBox="0 45 940 106" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <use xlink:href="img/encryption-scheme.svg#canvas1" />
        </svg>
        <p>Each vault has its own masterkey and HMAC key used for all cryptographic operations on its files and folders. The masterkey as well as the HMAC key are, depending on strength policy files, up to 256 bit long sequence of random data. They are generated using cryptographically secure PRNGs.</p>
        <p>Both keys are encrypted using RFC 3394 key wrapping with a key encrypting key derived from the user&apos;s password using Scrypt (fixed parallelization parameter of 1).</p>
        <p>
          <code>kek := scrypt(password, scryptSalt, scryptCostParam, scryptBlockSize)</code><br/>
          <code>primaryMasterKey := createRandomBytes(32)</code><br/>
          <code>hmacMasterKey := createRandomBytes(32)</code><br/>
          <code>cipheredPrimaryMasterKey := aesKeyWrap(primaryMasterKey, kek)</code><br/>
          <code>cipheredHmacMasterKey := aesKeyWrap(hmacMasterKey, kek)</code><br/>
        </p>
        <p>The wrapped keys and the parameters needed to derive the KEK are then stored as integers or Base64 strings in a JSON file named &quot;masterkey.cryptomator&quot;, which is located in the root directory of the vault.</p>
        <p>When unlocking a vault the KEK is used to unwrap (i.e. decrypt) the stored masterkeys.</p>

        <svg version="1.1" viewBox="0 205 940 218.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <use xlink:href="img/encryption-scheme.svg#canvas1" />
        </svg>
        <pre>{
  "version": 2, /* vault version for checking software compatibility */
  "scryptSalt": "wRo...c3M=",
  "scryptCostParam": 16384,
  "scryptBlockSize": 8,
  "keyLength": 256,
  "primaryMasterKey": "fKJgb...Roi3M=" /* cipheredPrimaryMasterKey */
  "hmacMasterKey": "uBaO8...16HWw=" /* cipheredHmacMasterKey */
}</pre>
      </div>

      <div class="col-md-12">
        <h3>File Header Encryption</h3>
        <svg version="1.1" viewBox="0 481.5 940 378.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <use xlink:href="img/encryption-scheme.svg#canvas1" />
        </svg>
        <p>Each file consists of a 104 byte header and the encrypted content padded by random data. The header carries the following information:</p>
        <ul>
          <li>128 bit random initialization vector.</li>
          <li>64 bit nonce. Both IV and nonce must be changed on each update of the file. Thus no partial updates are possible.</li>
          <li>Three AES-CBC encrypted blocks using PKCS#5 padding. The plaintext contains:
            <ul>
              <li>One 64 bit long integer (big-endian), which stores the actual file size in bytes.</li>
              <li>One 256 bit long random key. This key must also be changed on each update of the file.</li>
            </ul>
          </li>
          <li>A 256 bit MAC of the previous 64 bytes of this header.</li>
        </ul>
        <p>Starting with the 105th byte follows the encrypted content using AES-CTR. Counter mode allows random access to large files like videos (that&apos;s why the second part of the initialization vector is a long integer).</p>
        <p>
          <code>iv := createRandomBytes(16)</code><br/>
          <code>nonce := createRandomBytes(8)</code><br/>
          <code>fileKey := createRandomBytes(32)</code><br/>
          <code>fileSize := length(plaintext)</code><br/>
          <code>encryptedHeaderData := encryptAesCbc(fileSize || fileKey, primaryMasterKey, PKCS5_PADDING)</code><br/>
          <code>headerMac := hmacSha256(iv || encryptedFileLength, hmacMasterKey)</code><br/>
          <code>header := iv || nonce || encryptedHeaderData || headerMac</code><br/>
        </p>
      </div>

      <div class="col-md-12">
        <h3>File Content Encryption</h3>
        <svg version="1.1" viewBox="0 902.5 940 367.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <use xlink:href="img/encryption-scheme.svg#canvas1" />
        </svg>
        <p>Before encrypting, the plaintext is augmented by a random length random padding to obfuscate the actual file size. Then the plaintext is broken down into multiple chunks, each up to 32 KiB.</p>
        <p>Each chunk is then encrypted separately using AES-CTR with the unique key and nonce taken from the file&apos;s header.</p>
        <p>Afterwards a HMAC checksum is appended to the encrypted chunk. Additionally to the encrypted chunk the MAC is calculated over the header&apos;s IV as well as the chunk number to ensure chunks are in the correct order in the correct file.</p>
        <p>
          <code>randomPaddingLength := random() * min(max(fileSize * 10%, 4KiB), 16MiB)</code><br/>
          <code>arbitraryPadding := createRandomBytes(randomPaddingLength)</code><br/>
          <code>paddedPlaintext := plaintext || arbitraryPadding</code><br/>
          <code>plaintextChunks[] := split(paddedPlaintext, 32KiB)</code><br/>
          <code>encryptedChunks[] := encryptAesCtr(plaintextChunks[], fileKey, nonce)</code><br/>
          <code>foreach (encryptedChunk) {</code><br/>
          <code>&nbsp;&nbsp;mac := hmacSha256(iv || numberOf(encryptedChunk) || encryptedChunk, hmacMasterKey)</code><br/>
          <code>&nbsp;&nbsp;append(encryptedChunk, mac)</code><br/>
          <code>}</code><br/>
          <code>encryptedFileContent := join(encryptedChunk[])</code><br/>
        </p>
        <p>In order to decrypt only the plaintext (without the padding), the <code>fileSize</code> contained in the file header must be decrypted first.</p>
      </div>

      <div class="col-md-12">
        <h3>File Path Encryption and Directory Flattening</h3>
        <svg version="1.1" viewBox="0 1340 940 353" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <use xlink:href="img/encryption-scheme.svg#canvas1" />
        </svg>
        <p>Before a encrypted file is moved to the <code>d/</code> directory inside a vault, its file path gets encrypted too. This is done in two steps:</p>
        <ul>
          <li>Encryption and hashing of the directory path (anything before the last path separator)</li>
          <li>Encryption of the filename (anything after the last path separator)</li>
        </ul>
        <p>Hashing is not an additional level of security, but shortens the encrypted path dramatically. The encrypted-and-hashed directory name doesn&apos;t tell you anything about the number of directory levels in the plaintext path, which helps obfuscating directory structures.</p>
        <p>
          <code>encryptedDirPath := sha256(encryptAesSiv(plaintextDirPath, primaryMasterKey, hmacMasterKey))</code><br/>
          <code>encryptedFilename := encryptAesSiv(plaintextFilename, primaryMasterKey, hmacMasterKey) || ".file"</code><br/>
          <code>encryptedPath := "d/" || substring(encryptedDirPath, 0, 2) || "/" || substring(encryptedDirPath, 2, 32) || "/" || encryptedFilename</code>
        </p>
        <p>Encrypted filenames are Base32 encoded (to support case-insensitive file systems).</p>
      </div>

      <div class="col-md-12">
        <h3>Filename Length Limiting</h3>
        <p>The length of the encrypted name will be longer than the plaintext one. This is due to the 1.6x blow factor of Base32, the IV prefix and the file extension.</p>
        <p>For long filenames exceeding 136 characters, a supporting metadata file located in the <code>m/</code> directory of a vault is used to map the encrypted name to a shorter equivalent: Therefore a so-called <code>groupPrefix</code> is created from the first 8 chars of the original encrypted filename. A short filename consisting of the prefix followed by an UUID is used instead of the original encrypted filename. A metadata file contains a mapping dictionary between short and long encrypted filenames.</p>
        <p>
          <code>groupPrefix := substring(encryptedFilename, 0, 8)</code><br/>
          <code>uniqueShortName := groupPrefix || generateUuid() || ".lng.file"</code><br/>
          <code>correspondingMetadataFile := groupPrefix || ".meta"</code><br/>
          <code>metadataPath := "m/" || substring(correspondingMetadataFile, 0, 2) || "/" || correspondingMetadataFile(2, 8)</code>
        </p>
<pre>{
  "encryptedFilenames": {
    /* uuid: encryptedFilename */
    "5f6...98b": "WB7LC...HV32=="
  }
}</pre>
        <p>Filenames may of course share the same metadata file. But as collisions of the prefix happen rarely, we reduce the risk of concurrent I/O attempts.</p>
      </div>
    </div>

  </div>

  <!-- #################### CONTRIBUTE #################### -->

  <span class="clearfix anchor" id="contribute"></span>
  <div class="jumbotron">
    <div class="container">

      <div class="page-header text-center">
        <h2>Get Involved</h2>
        <p class="lead">Cryptomator is currently under development. There are still some things to do, so your help is greatly appreciated. Check the issues list on GitHub, maybe there are things, you can help with.</p>
        <p><a class="btn btn-primary btn-lg" href="https://github.com/cryptomator/cryptomator" role="button">Visit GitHub project</a></p>
        <p><iframe src="https://ghbtns.com/github-btn.html?user=cryptomator&repo=cryptomator&type=star&count=true&size=large" frameborder="0" scrolling="0" width="129px" height="30px"></iframe></p>
      </div>

    </div>
  </div>

  <!-- #################### FOOTER #################### -->

  <footer class="footer">
    <div class="container">
      <div class="pull-right">
        <a href="https://github.com/cryptomator/cryptomator" target="_blank"><img src="img/github_icon.png" srcset="img/github_icon.png 1x, img/github_icon@2x.png 2x" width="29" alt="Contribute to Cryptomator on GitHub"/></a>
        <a href="https://facebook.com/Cryptomator" target="_blank"><img src="img/fb_icon.png" width="29" alt="Like Cryptomator on Facebook"/></a>
        <a href="https://twitter.com/Cryptomator" target="_blank"><img src="img/twitter_icon.png" width="29" alt="Follow Cryptomator on Twitter"/></a>
      </div>
      <p>© cryptomator.org 2015 // <a href="privacy.html">Privacy Policy</a> // <a href="impressum.html" hreflang="de">Impressum</a> // <a href="datenschutz.html" hreflang="de">Datenschutz</a>
    </div>
  </footer>

  <!-- #################### COOKIE CONSENT #################### -->
  <div id="cookieConsent" data-ng-controller="CookiesCtrl" data-ng-show="!(consentGiven || consentDismissed)">
    <div class="pull-right">
      <button class="btn btn-sm btn-default" data-ng-click="agree()">Agree, don't show this again</button>
      <button class="btn btn-sm btn-default" data-ng-click="dismiss()">Ignore</button>
    </div>
    <p>This website wants to use cookies for statistical purposes. <a href="privacy.html">More info</a></p>
  </div>

</body>
</html>
